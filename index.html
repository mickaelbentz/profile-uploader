<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batch Profile Uploader 2</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Batch Profile Uploader 2</h1>
            <p>Importez et synchronisez vos contacts avec Batch</p>
        </header>

        <!-- Avertissement s√©curit√© -->
        <div class="security-warning">
            <div class="warning-content">
                ‚ö†Ô∏è <strong>Cette application ne doit PAS √™tre utilis√©e sur des Dash de clients. Elle ne peut qu'√™tre utilis√©e sur des Dash internes de test, et √™tre lanc√©e EN LOCAL.</strong>
            </div>
        </div>

        <!-- √âtape 1: Configuration API -->
        <div class="step-section" id="step-config">
            <div class="step-header">
                <span class="step-number">1</span>
                <h2>Configuration de l'API</h2>
            </div>

            <div class="form-group">
                <label for="api-key">API Key (REST API Key)</label>
                <input type="password" id="api-key" placeholder="Votre cl√© API Batch">
            </div>

            <div class="form-group">
                <label for="project-id">Project ID</label>
                <input type="text" id="project-id" placeholder="project_xxxxxxxxxx">
            </div>

            <button class="btn-primary" id="load-profiles-btn">
                Charger les profils existants
            </button>

            <p style="margin-top: 12px; font-size: 14px; color: #444649;">
                ‚ÑπÔ∏è Sur de grosses bases (> 100k profils), l'export peut prendre 10-30 minutes.
            </p>

            <div class="loader hidden" id="export-loader">
                <div class="loader-spinner"></div>
                <p id="loader-message">Chargement des profils existants...</p>
            </div>

            <div class="status-message hidden" id="export-status"></div>

            <div class="debug-logs hidden" id="debug-logs">
                <h4>D√©tails de debug:</h4>
                <pre id="debug-content"></pre>
            </div>
        </div>

        <!-- √âtape 2: Upload CSV -->
        <div class="step-section disabled" id="step-upload">
            <div class="step-header">
                <span class="step-number">2</span>
                <h2>Upload du fichier CSV</h2>
            </div>

            <div class="upload-area" id="upload-area">
                <div class="upload-icon">üìÑ</div>
                <h3>Glissez-d√©posez votre fichier CSV</h3>
                <p>ou cliquez pour parcourir</p>
                <input type="file" id="file-input" accept=".csv" hidden>
                <button class="btn-upload" id="browse-btn">Parcourir les fichiers</button>
            </div>

            <div class="file-info hidden" id="file-info">
                <div class="file-details">
                    <span class="file-name" id="file-name"></span>
                    <span class="file-size" id="file-size"></span>
                </div>
                <button class="btn-secondary" id="parse-btn">Analyser le fichier</button>
            </div>
        </div>

        <!-- √âtape 3: Validation des champs -->
        <div class="step-section disabled" id="step-validation">
            <div class="step-header">
                <span class="step-number">3</span>
                <h2>Validation des champs</h2>
            </div>

            <div id="fields-validation"></div>

            <div class="form-group">
                <label>
                    <input type="checkbox" id="update-strategy-merge" checked>
                    Fusionner les attributs (conserver les valeurs existantes non pr√©sentes dans le CSV)
                </label>
                <label>
                    <input type="checkbox" id="update-strategy-overwrite">
                    √âcraser tous les attributs (remplacer compl√®tement les profils existants)
                </label>
            </div>

            <button class="btn-primary" id="start-import-btn">
                Lancer l'importation
            </button>
        </div>

        <!-- √âtape 4: Rapport d'importation -->
        <div class="step-section disabled" id="step-report">
            <div class="step-header">
                <span class="step-number">4</span>
                <h2>Rapport d'importation</h2>
            </div>

            <div class="report-cards" id="report-cards"></div>

            <div class="report-details" id="report-details"></div>

            <div style="display: flex; gap: 16px; margin-top: 24px;">
                <button class="btn-primary" id="export-imported-btn" style="flex: 1;">
                    üì• Exporter les profils import√©s (CSV)
                </button>
                <button class="btn-secondary" id="reset-btn" style="flex: 1;">
                    üîÑ Nouvelle importation
                </button>
            </div>

            <p id="export-info" style="margin-top: 12px; font-size: 14px; color: #444649; text-align: center;"></p>

            <div class="loader hidden" id="export-profiles-loader">
                <div class="loader-spinner"></div>
                <p id="export-profiles-message">Export en cours...</p>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
